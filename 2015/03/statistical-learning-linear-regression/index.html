<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Jiye Qian" />
    <title>统计学习：线性回归</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <link href="/feed/" rel="alternate" title="Jiye Qian" type="application/atom+xml" />
    <link rel="stylesheet" href="/assets/css/style.css" />
    <link rel="stylesheet" href="/assets/css/pygments/default.css" />
    <link rel="stylesheet" href="/assets/css/pygments/default_inline.css" />
    <link rel="stylesheet" href="/assets/css/coderay.css" />

    <script type="text/javascript" src="/assets/js/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/outliner.js"></script>

    <!-- MathJax for LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        "HTML-CSS": { extensions: ["handle-floats.js"] },
        TeX: { equationNumbers: { autoNumber: "AMS" } },
        tex2jax: {
            inlineMath: [['$$$', '$$$'], ['$', '$'], ['\\(', '\\)']],
            processEscapes: true
        }
    });
    </script>
    <!-- <script type="text/javascript" src="/assets/js/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F0b514f17fd99b9fb4be74c94bdd2b7db' type='text/javascript'%3E%3C/script%3E"));
</script>
 -->
  </head>
<!--  <body>
-->
  <script type="text/javascript">
    function setTimeSpan(){
    	var date = new Date();
    	timeSpan.innerText=date.format('yyyy-MM-dd hh:mm:ss');
    }

    Date.prototype.format = function(format)
		{
    var o =
    	{
    	    "M+" : this.getMonth()+1, //month
    	    "d+" : this.getDate(),    //day
    	    "h+" : this.getHours(),   //hour
    	    "m+" : this.getMinutes(), //minute
    	    "s+" : this.getSeconds(), //second
    	    "q+" : Math.floor((this.getMonth()+3)/3),  //quarter
    	    "S" : this.getMilliseconds() //millisecond
    	}
    	if(/(y+)/.test(format))
    	format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
    	for(var k in o)
    	if(new RegExp("("+ k +")").test(format))
    	format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
    	return format;
		}
  </script>
  <body onLoad="setInterval(setTimeSpan,1000);">
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>统计学习：线性回归</h1>
        </header>
        <nav id="real_nav">
        
          <span><a title="Home" href="/">Home</a></span>
        
          <span><a title="Categories" href="/categories/">Categories</a></span>
        
          <span><a title="Tags" href="/tags/">Tags</a></span>
        
          <span><a title="Logs" href="/logs/">Logs</a></span>
        
          <span><a title="About" href="/about/">About</a></span>
        
          <span><a title="Subscribe" href="/feed/">Subscribe</a></span>
        
        </nav>
        <article class="content">
        <section class="meta">
<span class="time">
  <time datetime="2015-03-13">2015-03-13</time>
</span>

 |
<span class="categories">
  categories
  
  <a href="/categories/#研究学术" title="研究学术">研究学术</a>&nbsp;
  
</span>


 |
<span class="tags">
  tags
  
  <a href="/tags/#机器学习基础" title="机器学习基础">机器学习基础</a>&nbsp;
  
  <a href="/tags/#回归" title="回归">回归</a>&nbsp;
  
  <a href="/tags/#R" title="R">R</a>&nbsp;
  
</span>

</section>
<section class="post">
<h2 id="section">应用场景</h2>

<p>线性回归是研究其它一些统计学习方法的起点，其它方法可看作线性回归的扩展。</p>

<p>在<a href="http://www-bcf.usc.edu/~gareth/ISL/Advertising.csv">Advertising数据集</a>，某种商品销售额（sales）可视为电视（TV）、广播（radio）和报纸（newspaper）广告预算的函数。通过这些数据，能否解决如下问题：</p>

<ol>
  <li>广告预算和销量有关吗？</li>
  <li>如果相关，这种相关性有多强？也就是给定广告预算，能否准确预测销售额？</li>
  <li>各种类型的广告对销售额都有影响么吗？</li>
  <li>如果准确评估每种广告对销售额的影响？</li>
  <li>如何准确预测未来销售额？</li>
  <li>广告和销售额是线性关系吗？</li>
  <li>广告媒体之间有<strong>协同效应</strong>（synergy effect）吗？协同效应在统计学中称为<strong>相关性</strong>（interaction effect）。例如：在电视和广播分别投放\$50000的广告和将这\$100000投放到其中一种媒体，效果一样吗？</li>
</ol>

<h2 id="section-1">回归模型</h2>

<p>数学上，回归问题可表示为
\begin{equation}
Y\approx \beta_0 + \beta_1 X，
\end{equation}
$X$可以指代电视，$Y$表示销售额。$\beta_0 $和$\beta_1$分别表示<strong>截距</strong>（intercept）和<strong>斜率</strong>（slope）。模型参数用训练数据上的最小二乘法估计可得
\begin{equation}
\begin{aligned}
\hat\beta_1&amp;={\sum_{i=1}^n(x_i-\bar x)(y_i-\bar y)\over\sum_{i=1}^n(x_i-\bar x)^2}\\
\hat\beta_0&amp;=\bar y-\hat\beta_1\bar x，
\end{aligned}
\label{eq:lsm-coefficients}
\end{equation}
销售额可以预测
\[
\hat y=\hat\beta_0+\hat\beta_1x，
\]
符号$\hat{\;}$表示估计值。第$i$个样本的<strong>残差</strong>（residual）记为$e_i=y_i-\hat y_i$，$n$个样本的<strong>残差平方和</strong>（RSS，residual sum of squares）为
\begin{equation}
RSS=e_i^2+e_2^2+\ldots+e_n^2。
\label{eq:rss}
\end{equation}</p>

<p>假设$X$和$Y$的真实关系为
\begin{equation}
Y=\beta_0+\beta_1X+\epsilon，
\label{eq:population-regression-line}
\end{equation}
截断$\beta_0$表示当$X=0$是$Y$的取值，斜率$\beta_1$表示$X$增加一个单位$Y$的平均增加量，误差$\epsilon$代表了这个简单模型缺失的其它所有量。$X$和$Y$的真实关系可能不是线性的，还可能有其它量导致$Y$的改变，也可能有测量误差。通常假定误差项与$X$独立。</p>

<p>模型\eqref{eq:population-regression-line}定义了<strong>总体回归直线</strong>（population regression line），它是$X$和$Y$真实关系的最佳线性近似。最小二乘法估计的系数\eqref{eq:lsm-coefficients}确定了<strong>最小二乘直线</strong>（least squares line）。</p>

<div class="image_line" id="figure-1"><div class="image_card"><a href="/assets/images/2015-03-13-statistical-learning-linear-regression-experiment1.png"><img src="/assets/images/2015-03-13-statistical-learning-linear-regression-experiment1.png" alt="线性回归模型" /></a><div class="caption">图 1:  线性回归模型 [<a href="/assets/images/2015-03-13-statistical-learning-linear-regression-experiment1.png">PNG</a>]</div></div></div>

<p>上图左中，红色直线表示真实关系$f(X)=2+3X$，也就是总体回归线，深蓝色直线表示最小二乘直线，它是基于数据的最小二乘估计；上图右的浅蓝色直线是10次最小二乘法估计的结果，每次估计采用的不同数据集，但是10次估计的平均值很接近总体回归线。</p>

<p>每次实验的100组数据通过模型$Y=2+3X+\epsilon$随机生成，$\epsilon$由零均值的正态分布产生。在实际应用中，只能通过数据得到最小二乘直线，无法观察到总体回归直线。</p>

<p>在一个数据集上通过\eqref{eq:lsm-coefficients}无法得到参数的准确估计，但是通过在大量数据集上估计结果的平均，最小二乘直线就是总体回归直线的无偏（unbiased）估计。</p>

<p>参数估计估计的精度可以通过<strong>标准误差</strong>（SE，standard error）衡量，</p>

<p>\begin{equation}
\begin{aligned}
SE\left(\hat\beta_0\right)^2&amp;=\sigma^2\left[{1\over n}+{\bar x^2\over\sum_{i=1}^n(x_i-\bar x)^2}\right]\\
SE\left(\hat\beta_1\right)^2&amp;={\sigma^2\over\sum_{i=1}^n(x_i-\bar x)^2}，
\end{aligned}
\end{equation}</p>

<p>$\sigma$表示均方差（standard deviation），$\sigma^2=Var(\epsilon)$。</p>

<p>标准误差揭示了参数估计值和真实值之间的平均差异。公式严格成立的条件是每个样本的误差$\epsilon_i$和<strong>公共方差</strong>（common variance）无关。即使这个条件不成立，这个公式也可作为评估的很好近似。当$x_i$越分散时，$SE\left(\hat\beta_1\right)^2$越小；当$\bar x=0$时，$SE\left(\hat\beta_0\right)^2$也更小，此时$\hat\beta_0=\bar y$；随着样本数$n$的增加，$SE\left(\hat\beta_0\right)^2$也越来越小。通常$\sigma^2$未知，但可以通过数据集上的<strong>标准化残差</strong>（RSE，residual standard error）估计，</p>

<p>\begin{equation}
RSE=\sqrt{RSS\over n-2}。
\label{eq:rse}
\end{equation}</p>

<p>标准误差可以用于计算<strong>置信区间</strong>（confidence interval）。$95\%$的置信区间表示该区间有$95\%$的概率包括参数的真实值。对于线性回归的参数估计，$95\%$的置信区间记为<sup id="fnref:confidence-interval"><a href="#fn:confidence-interval" class="footnote">1</a></sup>：</p>

<p>\begin{equation}
\hat\beta_0\pm 2\cdot SE\left(\hat\beta_0\right)，\qquad
\hat\beta_1\pm 2\cdot SE\left(\hat\beta_1\right)。
\label{eq:lr-confidence-interval}
\end{equation}</p>

<p>标准误差也可用于系数的<strong>假设检验</strong>（hypothesis test）。最常用的两种假设检验是<strong>零假设检验</strong>（null hypothesis）和<strong>替代假设检验</strong>（alternative hypothesis），
\[
\begin{aligned}
H_0&amp;:\mbox{There is no relationship between }X\mbox{ and }Y\\
H_a&amp;:\mbox{There is some relationship between }X\mbox{ and }Y，
\end{aligned}
\]
数学上表示为
\[
H_0:\beta_1=0，\qquad H_a:\beta_1\neq0。
\]
若$\beta_1=0$，那么$X$和$Y$无关。进行零假设检验时，需要估计$\hat\beta_1$是否离0足够远，这需要通过$\hat\beta_1$的精度$SE\left(\hat\beta_1\right)$来衡量。如果$SE\left(\hat\beta_1\right)$很小，较小的$\hat\beta_1$可以足够确信$\beta_1\neq 0$；如果$SE\left(\hat\beta_1\right)$很大，$\hat\beta_1$的绝对值要很大才能拒绝零假设。在实际应用中，通过<strong>$t$统计量</strong>（$t$-statistic）</p>

<p>\begin{equation}
t={\hat\beta_1-0\over SE\left(\hat\beta_1\right)}
\label{eq:t-statistic}
\end{equation}</p>

<p>测量$\hat\beta_1$远离$0$的标准差（standard deviation）。如果$X$和$Y$真的无关，\eqref{eq:t-statistic}是$n-2$自由度的<strong>$t$分布</strong>（$t$-distribution）。当$n$大约大于$30$时，$t$分布与正态分布很相似。<strong>$p$值</strong>（$p$-value）表示$\beta_1=0$时观测值大于等于$|t|$的概率。较小的$p$值表示预测（predictor）与响应（response）之间有关联。若$p$值很小时，拒绝零假设（reject the null hypothesis）表示$X$与$Y$有关系。拒绝零假设的典型$p$值是$5\%$或$1\%$，当$n=30$时，相应的$t$统计量分别为$2$和$2.75$。<sup id="fnref:t-and-p-means"><a href="#fn:t-and-p-means" class="footnote">2</a></sup></p>

<div class="highlight"><pre><code>Call:
lm(formula = Price ~ AGST + WinterRain + HarvestRain + Age + 
    FrancePop, data = wine)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48179 -0.24662 -0.00726  0.22012  0.51987 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -4.504e-01  1.019e+01  -0.044 0.965202    
AGST         6.012e-01  1.030e-01   5.836 1.27e-05 ***
WinterRain   1.043e-03  5.310e-04   1.963 0.064416 .  
HarvestRain -3.958e-03  8.751e-04  -4.523 0.000233 ***
Age          5.847e-04  7.900e-02   0.007 0.994172    
FrancePop   -4.953e-05  1.667e-04  -0.297 0.769578    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3019 on 19 degrees of freedom
Multiple R-squared:  0.8294,    Adjusted R-squared:  0.7845 
F-statistic: 18.47 on 5 and 19 DF,  p-value: 1.044e-06
</code></pre></div>

<h2 id="section-2">参考资料</h2>

<ol class="bibliography"></ol>

<h3 id="section-3">脚注</h3>

<div class="footnotes">
  <ol>
    <li id="fn:confidence-interval">
      <p>Approximately for several reasons. Equation relies on the assumption that the errors are Gaussian. Also, the factor of $2$ in front of the $SE\left(\hat\beta_1\right)$ term will vary slightly depending on the number of observations $n$ in the linear regression. To be precise, rather than the number $2$, Equation should contain the $97.5\%$ quantile of a $t$-distribution with $n−2$ degrees of freedom.  <a href="#fnref:confidence-interval" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:t-and-p-means">
      <p>如何理解$t$分布、$p$值？ <a href="#fnref:t-and-p-means" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

</section>
<section align="right">
<br/>
<span>
  <a  href="/2015/03/efficient-pattern-mining-methods" class="pageNav"  >上一篇</a>
  &nbsp;&nbsp;&nbsp;
  <a   class="pageNavInvalid"  >下一篇</a>
</span>
</section>

	
	<ul class="ds-recent-visitors"></ul>
	<div class="ds-thread" data-thread-key="/2015/03/statistical-learning-linear-regression" data-url="http://qianjiye.de/2015/03/statistical-learning-linear-regression" data-title="统计学习：线性回归">
	</div>
	<script type="text/javascript">
	var first_image = document.getElementsByClassName("post")[0].getElementsByTagName("img")[0]; 
	if (first_image != undefined) {
	document.getElementsByClassName("ds-thread")[0].setAttribute("data-image", first_image.src);
	}
	</script>
		
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"jiyeqian"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>


<!-- <script type="text/javascript"> -->
<!-- $(function(){ -->
<!--   $(document).keydown(function(e) { -->
<!--     var url = false; -->
<!--         if (e.which == 37 || e.which == 72) {  // Left arrow and H -->
<!--          -->
<!--         url = '/2015/03/efficient-pattern-mining-methods'; -->
<!--          -->
<!--         } -->
<!--         else if (e.which == 39 || e.which == 76) {  // Right arrow and L -->
<!--          -->
<!--         } else if (e.which == 75) {  // K -->
<!--           url = '#'; -->
<!--         } else if (e.which == 74) { // J -->
<!--         url = '/2015/03/statistical-learning-linear-regression/#timeSpan'; -->
<!--         } -->
<!--         if (url) { -->
<!--             window.location = url; -->
<!--         } -->
<!--   }); -->
<!-- }) -->
<!-- </script> -->

        </article>
      </div>

    <footer>
        <p><small>
            Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> | Copyright 2014 - 2015 by <a href="/about/">Jiye Qian</a> | <span class="label label-info" id="timeSpan"></span></small></p>
    </footer>

    </div>
  </body>
</html>
